batch:
  post-crawling:
    job-name: crawlPostJob
    step-name: crawlPostStep
    chunk-size: 1
    retry-limit: 3
  processing:
    # Gemini API 5 RPM 제한에 최적화하기 위해 병렬 처리 수를 1로 제한합니다.
    # API Tier 업그레이드 시 이 값을 늘려 처리 속도를 향상시킬 수 있습니다.
    concurrency-limit: 1

content:
  selectors:
    techblog.woowahan.com:
      - ".post-content-inner > .post-content-body"

    tech.kakao.com:
      - ".inner_content > .daum-wm-content.preview"

    toss.tech:
      - "article.css-hvd0pt > div.css-1vn47db"

    d2.naver.com:
      - "article"
      - ".post-area"
      - ".section-content"
      - ".post-body"
      - ".content-area"

    helloworld.kurly.com:
      - ".post-content"
      - ".article-body"
      - ".post"

    medium.com:
      - "article"
      - ".meteredContent"
      - ".pw-post-body"
      - ".postArticle-content"

  default-selectors:
    - "article"
    - ".post-content"
    - ".entry-content"
    - "#content"
    - ".blog-post"


rate-limiter:
  gemini:
    limit-for-period: 8
    refresh-period-seconds: 60
    timeout-seconds: 30
  gemini-batch-rpm:
    limit-for-period: 5
    refresh-period-seconds: 60
    timeout-seconds: 60
  gemini-batch-rpd:
    limit-for-period: 20
    refresh-period-seconds: 86400
    timeout-seconds: 1
  crawler:
    conservative:
      limit-for-period: 15
      refresh-period-seconds: 60
      timeout-seconds: 300
    default:
      limit-for-period: 20
      refresh-period-seconds: 60
      timeout-seconds: 300

circuit-breaker:
  gemini-batch:
    failure-rate-threshold: 50  # 실패율 50% 이상 시 오픈
    slow-call-rate-threshold: 80  # 느린 호출 80% 이상 시 오픈
    slow-call-duration-threshold-seconds: 180  # 30초 이상 걸리면 느린 호출로 간주
    wait-duration-in-open-state-seconds: 60  # OPEN 상태 60초 유지
    permitted-number-of-calls-in-half-open-state: 3  # HALF_OPEN 시 3개 호출 허용
    sliding-window-size: 10  # 최근 10개 호출 기준
    minimum-number-of-calls: 5  # 최소 5개 호출 후 통계 계산

gemini:
  api-key: ${GEMINI_API_KEY}
  max-output-tokens: 16384